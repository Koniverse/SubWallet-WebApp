"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_web_runner=("undefined"!=typeof self?self:this).webpackChunk_subwallet_web_runner||[]).push([[3589,3738],{13738:(e,n,t)=>{t.r(n),t.d(n,{TransactionContext:()=>N,default:()=>T});var a=t(9661),s=t(31101),r=t(11637),o=t(87574),i=t(75576),l=t(33283),c=t(12162),d=t(90809),u=t(72779),m=t.n(u),h=t(2784),f=t(35185),g=t(73557),p=t(38338),x=t(68774),v=t(52322);const N=h.createContext({transactionType:a.Vv.TRANSFER_BALANCE,from:"",setFrom:e=>{},chain:"",setChain:e=>{},asset:"",setAsset:e=>{},onDone:e=>{},onClickRightBtn:()=>{},setShowRightBtn:e=>{},setDisabledRightBtn:e=>{}}),T=(0,p.ZP)((function({className:e}){const{t:n}=(0,l.$G)(),t=(0,g.TH)(),u=(0,g.s0)(),{activeModal:p}=(0,h.useContext)(c.t),T=(0,h.useContext)(i.R0),{currentAccount:E,isAllAccount:b}=(0,f.v9)((e=>e.accountState)),k=(0,h.useMemo)((()=>{switch(t.pathname.split("/")[2]||""){case"stake":return a.Vv.STAKING_JOIN_POOL;case"unstake":return a.Vv.STAKING_LEAVE_POOL;case"cancel-unstake":return a.Vv.STAKING_CANCEL_UNSTAKE;case"claim-reward":return a.Vv.STAKING_CLAIM_REWARD;case"withdraw":return a.Vv.STAKING_WITHDRAW;case"compound":return a.Vv.STAKING_COMPOUNDING;case"send-nft":return a.Vv.SEND_NFT;default:return a.Vv.TRANSFER_BALANCE}}),[t.pathname]),y=(0,h.useMemo)((()=>{switch(t.pathname.split("/")[2]||""){case"stake":case"unstake":case"cancel-unstake":case"claim-reward":case"withdraw":case"compound":return"/home/staking";case"send-nft":return"/home/nfts/collections";default:return"/home/tokens"}}),[t.pathname]),j=(0,h.useMemo)((()=>{const e={};for(const[t,a]of Object.entries(o.mG))e[t]=n(a);return e}),[n]);(0,l.qg)(y);const[O,S]=(0,h.useState)(b?"":(null==E?void 0:E.address)||""),[C,w]=(0,h.useState)(""),[I,A]=(0,h.useState)(""),[P,B]=(0,h.useState)(!1),[M,Z]=(0,h.useState)(!1),L=(0,l.xC)(),_=(0,h.useCallback)((()=>{u(y)}),[y,u]),R=(0,h.useCallback)((e=>{const n=(0,x.u)(O)?"ethereum":"substrate";u(`/transaction-done/${n}/${C}/${e}`,{replace:!0})}),[O,C,u]),D=(0,h.useCallback)((()=>{k===a.Vv.STAKING_JOIN_POOL&&p(r.p)}),[p,k]),W=(0,h.useMemo)((()=>P?[{disabled:M,icon:(0,v.jsx)(s.sz,{}),onClick:()=>D()}]:[]),[M,D,P]);return(0,h.useEffect)((()=>{""!==I&&L(I)}),[I,L]),(0,v.jsx)(s.Ar.Home,{showFilterIcon:!0,showTabBar:!1,children:(0,v.jsx)(N.Provider,{value:{transactionType:k,from:O,setFrom:S,chain:C,setChain:w,onDone:R,onClickRightBtn:D,setShowRightBtn:B,setDisabledRightBtn:Z,asset:I,setAsset:A},children:(0,v.jsx)(s.FE,{resolve:T.awaitStores(["chainStore","assetRegistry","balance"]),children:(0,v.jsxs)("div",{className:m()(e,"transaction-wrapper"),children:[(0,v.jsx)(d.Z,{background:"transparent",center:!0,className:"transaction-header",onBack:_,rightButtons:W,showBackButton:!0,title:j[k]}),(0,v.jsx)(g.j3,{})]})})})})})).withConfig({displayName:"Transaction",componentId:"sc-1qz55vb-0"})((({theme:e})=>{const n=e.token;return{height:"100%",display:"flex",flexDirection:"column",".transaction-header":{paddingTop:n.paddingSM,paddingBottom:n.paddingSM,flexShrink:0},".transaction-content":{flex:"1 1 400px",paddingLeft:n.padding,paddingRight:n.padding,overflow:"auto"},".transaction-footer":{display:"flex",flexWrap:"wrap",padding:`${n.paddingMD}px ${n.padding}px ${n.padding}px`,marginBottom:n.padding,gap:n.paddingXS,".error-messages":{width:"100%",color:n.colorError},".warning-messages":{width:"100%",color:n.colorWarning},".ant-btn":{flex:1},".full-width":{minWidth:"100%"}}}}))},52274:(e,n,t)=>{t.d(n,{nC:()=>f,x1:()=>g.x1,bO:()=>i});var a=t(80949),s=t(54533);const r="RMRK",o="SEND";function i(e,n){return e.type===a.Ym.ERC721?function(e){return{contractAddress:e.collectionId,tokenId:parseInt(e.id)}}(e):e.type===a.Ym.PSP34?function(e){return{contractAddress:e.collectionId,onChainOption:e.onChainOption,isPsp34:!0,networkKey:e.chain}}(e):s.r$.acala.includes(n)||s.r$.karura.includes(n)||s.r$.bitcountry.includes(n)?function(e){return{collectionId:parseInt(e.collectionId),itemId:parseInt(e.id),networkKey:e.chain}}(e):s.r$.rmrk.includes(n)?function(e){return e.rmrk_ver?{remark:`${r}::${o}::${e.rmrk_ver}::${e.id}::`,networkKey:e.chain}:{}}(e):s.r$.statemine.includes(n)||s.r$.unique_network.includes(n)?function(e){return{collectionId:parseInt(e.collectionId),itemId:parseInt(e.id),networkKey:e.chain}}(e):{}}var l=t(9661),c=t(36926),d=t(95110),u=t(95798),m=t(68774);const h=(e,n)=>t=>!(t.originGenesisHash&&n&&(0,c.zb)(n)!==t.originGenesisHash||(0,u.W_)(t.address)||t.isReadOnly||e===l.WQ.POOLED&&(0,m.u)(t.address)),f=(e,n,t)=>a=>{if(t&&t!==d.EN){const s=e[t],r=h(n,s),o=(0,c.h4)(s);return r(a)&&o===(0,m.u)(a.address)}return h(n)(a)};var g=t(11164)},94684:(e,n,t)=>{t.d(n,{gy:()=>u,ZL:()=>f,tc:()=>g,Xd:()=>p});var a=t(43246),s=t(96562),r=t(25690),o=t(72779),i=t.n(o),l=t(2784),c=t(38338),d=t(52322);const u=(0,c.ZP)((({bondedBalance:e,className:n,decimals:t,label:o,symbol:l})=>{const{t:u}=(0,a.Z)(),{token:m}=(0,c.Fg)();return(0,d.jsxs)(s.Z.Paragraph,{className:i()(n,"bonded-balance"),children:[(0,d.jsx)(r.Z,{decimal:t,decimalColor:m.colorTextTertiary,intColor:m.colorTextTertiary,size:14,suffix:l,unitColor:m.colorTextTertiary,value:e||0}),o||u("Bonded")]})})).withConfig({displayName:"BondedBalance",componentId:"sc-15arqr7-0"})((({theme:{token:e}})=>({display:"flex",color:e.colorTextTertiary,"&.ant-typography":{marginBottom:0},".ant-number":{marginRight:"0.3em"}})));var m=t(33283),h=t(96108);const f=(0,c.ZP)((({address:e,chain:n,className:t,label:o,onBalanceReady:u,tokenSlug:f})=>{const{t:g}=(0,a.Z)(),{token:p}=(0,c.Fg)(),{error:x,isLoading:v,nativeTokenBalance:N,nativeTokenSlug:T,tokenBalance:E}=(0,m.L5)(n,e,f);return(0,l.useEffect)((()=>{null==u||u(!v&&!x)}),[x,v,u]),e||n?(0,d.jsxs)(s.Z.Paragraph,{className:i()(t,"free-balance"),children:[o||g("Sender available balance:")," ",v&&(0,d.jsx)(h.Z,{size:14}),x&&(0,d.jsx)(s.Z.Text,{className:"error-message",children:x}),!v&&!x&&!!T&&(0,d.jsx)(r.Z,{decimal:N.decimals||18,decimalColor:p.colorTextTertiary,intColor:p.colorTextTertiary,size:14,suffix:N.symbol,unitColor:p.colorTextTertiary,value:N.value}),!v&&!x&&!!f&&f!==T&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("span",{className:"__name",children:[" ",g("and")," "]}),(0,d.jsx)(r.Z,{decimal:(null==E?void 0:E.decimals)||18,decimalColor:p.colorTextTertiary,intColor:p.colorTextTertiary,size:14,suffix:null==E?void 0:E.symbol,unitColor:p.colorTextTertiary,value:E.value})]})]}):(0,d.jsx)(d.Fragment,{})})).withConfig({displayName:"FreeBalance",componentId:"sc-f3bkwa-0"})((({theme:{token:e}})=>({display:"flex",flexWrap:"wrap",color:e.colorTextTertiary,".error-message":{color:e.colorError},"&.ant-typography":{marginBottom:0}}))),g=(0,c.ZP)((({children:e,className:n=""})=>(0,d.jsx)("div",{className:`transaction-content ${n}`,children:e}))).withConfig({displayName:"TransactionContent",componentId:"sc-17nushy-0"})((({theme:e})=>({}))),p=(0,c.ZP)((({children:e,className:n="",errors:t,warnings:a})=>(0,d.jsxs)("div",{className:`transaction-footer ${n}`,children:[t.length>0&&(0,d.jsx)("div",{className:"error-messages",children:t.map(((e,n)=>(0,d.jsx)("div",{children:e},n)))}),a.length>0&&(0,d.jsx)("div",{className:"warning-messages",children:a.map(((e,n)=>(0,d.jsx)("div",{children:e},n)))}),e]}))).withConfig({displayName:"TransactionFooter",componentId:"sc-bpci6r-0"})((({theme:e})=>({})))},63589:(e,n,t)=>{t.r(n),t.d(n,{default:()=>w});var a=t(9661),s=t(54533),r=t(36926),o=t(31101),i=t(87574),l=t(75576),c=t(33283),d=t(2784),u=t(35185),m=t(92936),h=t(95798),f=t(12798),g=t(81345),p=t(92280),x=t(99656),v=t(72558),N=t(94344),T=t(96217),E=t(73557),b=t(38338),k=t(68774),y=t(52274),j=t(94684),O=t(13738),S=t(52322),C=function(e){return e.VALUE="amount",e.NOMINATE="nominate",e.POOL="pool",e.TYPE="type",e}(C||{});const w=(0,b.ZP)((e=>{const{className:n}=e,{t}=(0,T.$)(),{chain:b,type:w}=(0,E.UO)(),I=(0,d.useContext)(l.R0),{asset:A,chain:P,from:B,onDone:M,setAsset:Z,setChain:L,setDisabledRightBtn:_,setFrom:R,setShowRightBtn:D}=(0,d.useContext)(O.TransactionContext),{nominationPoolInfoMap:W,validatorInfoMap:F}=(0,c.v9)((e=>e.bonding)),V=(0,c.v9)((e=>e.chainStore.chainInfoMap)),$=(0,c.wE)(P),Q=(0,c.v9)((e=>e.accountState.currentAccount)),K=function(e){const n=(0,u.v9)((e=>e.assetRegistry.assetRegistry));return(0,d.useMemo)((()=>n[e]),[n,e])}(A),G=(0,k.u)(null==Q?void 0:Q.address),z=(0,d.useMemo)((()=>{if(G)return a.WQ.NOMINATED;switch(w){case a.WQ.POOLED:return a.WQ.POOLED;case a.WQ.NOMINATED:return a.WQ.NOMINATED;default:return a.WQ.POOLED}}),[w,G]),[Y]=f.Z.useForm(),[H,U]=(0,d.useState)(!0),q=f.Z.useWatch(C.TYPE,Y),J=(0,c.aJ)(P),X=(0,c._y)(P,q,B),ee=(0,d.useMemo)((()=>X[0]),[X]),{nativeTokenBalance:ne}=(0,c.L5)(P,B),te=(0,c.O_)(q,B,b),ae=(0,d.useMemo)((()=>s.H_.relay.includes(P)),[P]),[se,re]=(0,d.useState)(!1),[oe,ie]=(0,d.useState)(!1),[le,ce]=(0,d.useState)(!1),[de,ue]=(0,d.useState)(!0),[me,he]=(0,d.useState)(!1),[,fe]=(0,d.useState)({}),ge=(0,d.useMemo)((()=>K&&K.minAmount||"0"),[K]),pe=(0,d.useMemo)((()=>{const e=new v.Z(ne.value),n=new v.Z(ge);return n.gte(e)?"0":e.minus(n).toString()}),[ge,ne.value]),{decimals:xe,symbol:ve}=(0,c.cR)(P),Ne=(0,h.W_)((null==Q?void 0:Q.address)||""),Te=(0,c.uH)(b||""),Ee=(0,d.useMemo)((()=>({asset:Te,from:B,chain:P,[C.VALUE]:"0",[C.POOL]:"",[C.NOMINATE]:"",[C.TYPE]:z})),[Te,B,z,P]),be=(0,d.useMemo)((()=>q===a.WQ.POOLED?(null==J?void 0:J.minPoolBonding)||"0":(null==J?void 0:J.minStake)||"0"),[null==J?void 0:J.minPoolBonding,null==J?void 0:J.minStake,q]),{onError:ke,onSuccess:ye}=(0,c.Ls)(M),je=(0,d.useCallback)(((e,n)=>{const{error:t}=(0,h.ij)(n),s=(0,h.eW)(n),o=(0,h.eW)(e),{amount:i,asset:l,from:c}=o;if(i&&he(!0),c&&R(c),void 0!==l){const e=(0,r.QJ)(l);Z(l),L(e)}const d={},u=s[C.TYPE];for(const[e,n]of Object.entries(s))d[e]=!!n;u===a.WQ.NOMINATED?d.pool=!0:u===a.WQ.POOLED&&(d.nominate=!0),U(t||Object.values(d).some((e=>!e)))}),[Z,L,R]),Oe=(0,d.useCallback)((e=>{const n=F[P];if(!n)return[];const t=[];return n.forEach((n=>{e.includes((0,h.k1)(n.address,42))&&t.push(n)})),t}),[P,F]),Se=(0,d.useCallback)((e=>{const n=W[P];for(const t of n)if(String(t.id)===e)return t}),[W,P]),Ce=(0,d.useCallback)((e=>{re(!0);const{from:n,[C.NOMINATE]:t,[C.POOL]:s,[C.VALUE]:r,[C.TYPE]:o}=e;let i;if(s&&o===a.WQ.POOLED){const e=Se(s);i=(0,m.qg)({amount:r,chain:P,nominatorMetadata:ee,selectedPool:e,address:n})}else{const e=Oe((0,h.in)(t));i=(0,m.Qx)({amount:r,chain:P,nominatorMetadata:ee,selectedValidators:e,address:n,type:a.WQ.NOMINATED})}setTimeout((()=>{i.then(ye).catch(ke).finally((()=>{re(!1)}))}),300)}),[Se,P,ee,Oe,ye,ke]),we=(0,d.useCallback)((()=>J?(0,S.jsxs)(o.oB,{className:"meta-info",labelColorScheme:"gray",spaceSize:"xs",valueColorScheme:"light",children:[J.expectedReturn&&(0,S.jsx)(o.oB.Number,{label:t("Estimated earnings:"),suffix:"% / year",value:J.expectedReturn}),J.minStake&&(0,S.jsx)(o.oB.Number,{decimals:xe,label:t("Minimum active:"),suffix:ve,value:be,valueColorSchema:"success"})]}):null),[J,xe,ve,t,be]),Ie=(0,c.Ey)(B);return(0,d.useEffect)((()=>{const e=(null==Q?void 0:Q.address)||"";e&&((0,h.W_)(e)||R(e))}),[null==Q?void 0:Q.address,R]),(0,d.useEffect)((()=>{b&&b!==i.EN&&L(b)}),[L,b]),(0,d.useEffect)((()=>{Z(Te)}),[Te,Z]),(0,d.useEffect)((()=>{D(!0)}),[D]),(0,d.useEffect)((()=>{_(!J)}),[J,_]),(0,d.useEffect)((()=>{let e=!1;return P&&B&&null!=$&&$.active&&(0,y.x1)(P,w||i.EN,e,ie,ce),()=>{e=!0}}),[B,w,P,null==$?void 0:$.active]),(0,d.useEffect)((()=>{let e=!1;return me&&(e||setTimeout((()=>{Y.validateFields([C.VALUE]).finally((()=>fe({})))}),100)),()=>{e=!0}}),[Y,ne.value]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(j.tc,{children:(0,S.jsxs)(o.FE,{className:n,resolve:I.awaitStores(["staking"]),children:[(0,S.jsxs)(f.Z,{className:"form-container form-space-sm",form:Y,initialValues:Ee,onFieldsChange:je,onFinish:Ce,children:[(0,S.jsx)(f.Z.Item,{className:"staking-type",hidden:w!==i.EN,name:C.TYPE,children:(0,S.jsx)(o.Ee,{optionType:"button",options:[{label:"Pools",value:a.WQ.POOLED,disabled:G},{label:"Nominate",value:a.WQ.NOMINATED}]})}),(0,S.jsx)(f.Z.Item,{hidden:!Ne,name:"from",children:(0,S.jsx)(o.pK,{filter:(0,y.nC)(V,q,b)})}),!Ne&&(0,S.jsx)(f.Z.Item,{name:"asset",children:(0,S.jsx)(o.kB,{disabled:b!==i.EN||!B,items:te,prefixShape:"circle"})}),(0,S.jsx)(j.ZL,{address:B,chain:P,className:"account-free-balance",label:t("Available balance:"),onBalanceReady:ue}),(0,S.jsxs)("div",{className:"form-row",children:[Ne&&(0,S.jsx)(f.Z.Item,{name:"asset",children:(0,S.jsx)(o.kB,{disabled:b!==i.EN||!B,items:te,prefixShape:"circle"})}),(0,S.jsx)(f.Z.Item,{name:C.VALUE,rules:[{required:!0},({getFieldValue:e})=>({validator:(n,s)=>{const r=e(C.TYPE),o=new v.Z(s);if(r===a.WQ.POOLED){if(o.lte(0))return Promise.reject(new Error("Amount must be greater than 0"))}else if((null==ee||!ee.isBondedBefore||!ae)&&o.lte(0))return Promise.reject(new Error("Amount must be greater than 0"));return o.gt(ne.value)?Promise.reject(t("Amount cannot exceed your balance")):Promise.resolve()}})],statusHelpAsTooltip:!0,children:(0,S.jsx)(o._Z,{decimals:P&&B?xe:-1,maxValue:pe,showMaxButton:!1})})]}),(0,S.jsx)(f.Z.Item,{hidden:q!==a.WQ.POOLED,name:C.POOL,children:(0,S.jsx)(o.Tz,{chain:P,from:B,label:t("Select pool"),loading:oe})}),(0,S.jsx)(f.Z.Item,{hidden:q!==a.WQ.NOMINATED,name:C.NOMINATE,children:(0,S.jsx)(o.OF,{chain:A?P:"",from:A?B:"",loading:le})})]}),J&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.Z,{className:"staking-divider"}),we()]})]})}),(0,S.jsx)(j.Xd,{errors:[],warnings:[],children:(0,S.jsx)(p.Z,{disabled:H||!de,icon:(0,S.jsx)(x.Z,{phosphorIcon:N.Z,weight:"fill"}),loading:se,onClick:Ie(Y.submit),children:t("Stake")})}),J&&(0,S.jsx)(o.R5,{activeNominators:J.nominatorCount,estimatedEarning:J.expectedReturn,inflation:J.inflation,maxValidatorPerNominator:J.maxValidatorPerNominator,minimumActive:{decimals:xe,value:be,symbol:ve},stakingType:q,unstakingPeriod:J.unstakingPeriod})]})})).withConfig({displayName:"Stake",componentId:"sc-abqz0v-0"})((({theme:{token:e}})=>({".staking-type":{marginBottom:e.margin},".account-free-balance":{marginBottom:e.marginXS},".meta-info":{marginTop:e.paddingSM},".react-tabs__tab-list":{marginLeft:0,marginRight:0},".staking-divider":{marginTop:e.margin+2,marginBottom:e.marginSM}})))}}]);