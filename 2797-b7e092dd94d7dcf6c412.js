"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_web_runner=("undefined"!=typeof self?self:this).webpackChunk_subwallet_web_runner||[]).push([[2797,3738],{13738:(e,n,s)=>{s.r(n),s.d(n,{TransactionContext:()=>C,default:()=>b});var t=s(9661),a=s(51076),i=s(11637),r=s(63470),o=s(75576),l=s(29709),c=s(12162),d=s(90809),u=s(72779),h=s.n(u),m=s(2784),g=s(35185),f=s(73557),p=s(38338),x=s(68774),v=s(52322);const C=m.createContext({transactionType:t.Vv.TRANSFER_BALANCE,from:"",setFrom:e=>{},chain:"",setChain:e=>{},asset:"",setAsset:e=>{},onDone:e=>{},onClickRightBtn:()=>{},setShowRightBtn:e=>{},setDisabledRightBtn:e=>{}}),b=(0,p.ZP)((function({className:e}){const{t:n}=(0,l.$G)(),s=(0,f.TH)(),u=(0,f.s0)(),{activeModal:p}=(0,m.useContext)(c.t),b=(0,m.useContext)(o.R0),{currentAccount:T,isAllAccount:y}=(0,g.v9)((e=>e.accountState)),j=(0,m.useMemo)((()=>{switch(s.pathname.split("/")[2]||""){case"stake":return t.Vv.STAKING_JOIN_POOL;case"unstake":return t.Vv.STAKING_LEAVE_POOL;case"cancel-unstake":return t.Vv.STAKING_CANCEL_UNSTAKE;case"claim-reward":return t.Vv.STAKING_CLAIM_REWARD;case"withdraw":return t.Vv.STAKING_WITHDRAW;case"compound":return t.Vv.STAKING_COMPOUNDING;case"send-nft":return t.Vv.SEND_NFT;default:return t.Vv.TRANSFER_BALANCE}}),[s.pathname]),w=(0,m.useMemo)((()=>{switch(s.pathname.split("/")[2]||""){case"stake":case"unstake":case"cancel-unstake":case"claim-reward":case"withdraw":case"compound":return"/home/staking";case"send-nft":return"/home/nfts/collections";default:return"/home/tokens"}}),[s.pathname]),N=(0,m.useMemo)((()=>{const e={};for(const[s,t]of Object.entries(r.mG))e[s]=n(t);return e}),[n]);(0,l.qg)(w);const[k,S]=(0,m.useState)(y?"":(null==T?void 0:T.address)||""),[A,Z]=(0,m.useState)(""),[B,_]=(0,m.useState)(""),[I,F]=(0,m.useState)(!1),[E,P]=(0,m.useState)(!1),R=(0,l.xC)(),M=(0,m.useCallback)((()=>{u(w)}),[w,u]),V=(0,m.useCallback)((e=>{const n=(0,x.u)(k)?"ethereum":"substrate";u(`/transaction-done/${n}/${A}/${e}`,{replace:!0})}),[k,A,u]),L=(0,m.useCallback)((()=>{j===t.Vv.STAKING_JOIN_POOL&&p(i.p)}),[p,j]),D=(0,m.useMemo)((()=>I?[{disabled:E,icon:(0,v.jsx)(a.sz,{}),onClick:()=>L()}]:[]),[E,L,I]);return(0,m.useEffect)((()=>{""!==B&&R(B)}),[B,R]),(0,v.jsx)(a.Ar.Home,{showFilterIcon:!0,showTabBar:!1,children:(0,v.jsx)(C.Provider,{value:{transactionType:j,from:k,setFrom:S,chain:A,setChain:Z,onDone:V,onClickRightBtn:L,setShowRightBtn:F,setDisabledRightBtn:P,asset:B,setAsset:_},children:(0,v.jsx)(a.FE,{resolve:b.awaitStores(["chainStore","assetRegistry","balance"]),children:(0,v.jsxs)("div",{className:h()(e,"transaction-wrapper"),children:[(0,v.jsx)(d.Z,{background:"transparent",center:!0,className:"transaction-header",onBack:M,rightButtons:D,showBackButton:!0,title:N[j]}),(0,v.jsx)(f.j3,{})]})})})})})).withConfig({displayName:"Transaction",componentId:"sc-1qz55vb-0"})((({theme:e})=>{const n=e.token;return{height:"100%",display:"flex",flexDirection:"column",".transaction-header":{paddingTop:n.paddingSM,paddingBottom:n.paddingSM,flexShrink:0},".transaction-content":{flex:"1 1 400px",paddingLeft:n.padding,paddingRight:n.padding,overflow:"auto"},".transaction-footer":{display:"flex",flexWrap:"wrap",padding:`${n.paddingMD}px ${n.padding}px ${n.padding}px`,marginBottom:n.padding,gap:n.paddingXS,".error-messages":{width:"100%",color:n.colorError},".warning-messages":{width:"100%",color:n.colorWarning},".ant-btn":{flex:1},".full-width":{minWidth:"100%"}}}}))},94684:(e,n,s)=>{s.d(n,{gy:()=>u,ZL:()=>g,tc:()=>f,Xd:()=>p});var t=s(43246),a=s(96562),i=s(25690),r=s(72779),o=s.n(r),l=s(2784),c=s(38338),d=s(52322);const u=(0,c.ZP)((({bondedBalance:e,className:n,decimals:s,label:r,symbol:l})=>{const{t:u}=(0,t.Z)(),{token:h}=(0,c.Fg)();return(0,d.jsxs)(a.Z.Paragraph,{className:o()(n,"bonded-balance"),children:[(0,d.jsx)(i.Z,{decimal:s,decimalColor:h.colorTextTertiary,intColor:h.colorTextTertiary,size:14,suffix:l,unitColor:h.colorTextTertiary,value:e||0}),r||u("Bonded")]})})).withConfig({displayName:"BondedBalance",componentId:"sc-15arqr7-0"})((({theme:{token:e}})=>({display:"flex",color:e.colorTextTertiary,"&.ant-typography":{marginBottom:0},".ant-number":{marginRight:"0.3em"}})));var h=s(29709),m=s(96108);const g=(0,c.ZP)((({address:e,chain:n,className:s,label:r,onBalanceReady:u,tokenSlug:g})=>{const{t:f}=(0,t.Z)(),{token:p}=(0,c.Fg)(),{error:x,isLoading:v,nativeTokenBalance:C,nativeTokenSlug:b,tokenBalance:T}=(0,h.L5)(n,e,g);return(0,l.useEffect)((()=>{console.log("onBalanceReady",!v&&!x),null==u||u(!v&&!x)}),[x,v,u]),e||n?(0,d.jsxs)(a.Z.Paragraph,{className:o()(s,"free-balance"),children:[r||f("Sender available balance:")," ",v&&(0,d.jsx)(m.Z,{size:14}),x&&(0,d.jsx)(a.Z.Text,{className:"error-message",children:x}),!v&&!x&&!!b&&(0,d.jsx)(i.Z,{decimal:C.decimals||18,decimalColor:p.colorTextTertiary,intColor:p.colorTextTertiary,size:14,suffix:C.symbol,unitColor:p.colorTextTertiary,value:C.value}),!v&&!x&&!!g&&g!==b&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("span",{className:"__name",children:[" ",f("and")," "]}),(0,d.jsx)(i.Z,{decimal:(null==T?void 0:T.decimals)||18,decimalColor:p.colorTextTertiary,intColor:p.colorTextTertiary,size:14,suffix:null==T?void 0:T.symbol,unitColor:p.colorTextTertiary,value:T.value})]})]}):(0,d.jsx)(d.Fragment,{})})).withConfig({displayName:"FreeBalance",componentId:"sc-f3bkwa-0"})((({theme:{token:e}})=>({display:"flex",flexWrap:"wrap",color:e.colorTextTertiary,".error-message":{color:e.colorError},"&.ant-typography":{marginBottom:0}}))),f=(0,c.ZP)((({children:e,className:n=""})=>(0,d.jsx)("div",{className:`transaction-content ${n}`,children:e}))).withConfig({displayName:"TransactionContent",componentId:"sc-17nushy-0"})((({theme:e})=>({}))),p=(0,c.ZP)((({children:e,className:n="",errors:s,warnings:t})=>(0,d.jsxs)("div",{className:`transaction-footer ${n}`,children:[s.length>0&&(0,d.jsx)("div",{className:"error-messages",children:s.map(((e,n)=>(0,d.jsx)("div",{children:e},n)))}),t.length>0&&(0,d.jsx)("div",{className:"warning-messages",children:t.map(((e,n)=>(0,d.jsx)("div",{children:e},n)))}),e]}))).withConfig({displayName:"TransactionFooter",componentId:"sc-bpci6r-0"})((({theme:e})=>({})))},42797:(e,n,s)=>{s.r(n),s.d(n,{default:()=>P});var t=s(80949),a=s(36926),i=s(56858),r=s(76806),o=s(32623),l=s(92323),c=s(23214),d=s(11638),u=s(63470),h=s(29709),m=s(92936),g=s(95798),f=s(32897),p=s(12798),x=s(25356),v=s(92280),C=s(99656),b=s(72558),T=s(72779),y=s.n(T),j=s(62982),w=s(2784),N=s(96217),k=s(73557),S=s(38338),A=s(68774),Z=s(24854),B=s(94684),_=s(13738),I=s(52322);function F(e,n,s){return(0,a.h4)(n[e.originChain])===s}const E=e=>!((0,g.W_)(e.address)||e.isReadOnly),P=(0,S.ZP)((({className:e=""})=>{var n;const{t:s}=(0,N.$)(),T=(0,k.TH)().state,[S]=(0,w.useState)(null==T?void 0:T.slug),{asset:P,chain:R,from:M,onDone:V,setAsset:L,setChain:D,setFrom:O}=(0,w.useContext)(_.TransactionContext),{chainInfoMap:G,chainStateMap:$}=(0,h.v9)((e=>e.chainStore)),{assetRegistry:K,assetSettingMap:H,multiChainAssetMap:W,xcmRefMap:z}=(0,h.v9)((e=>e.assetRegistry)),{accounts:q,isAllAccount:J}=(0,h.v9)((e=>e.accountState)),[U,X]=(0,w.useState)("0"),Y=(0,h.Ey)(M,"The account you are using is read-only, you cannot send assets with it"),[Q,ee]=(0,w.useState)(!1),[ne,se]=(0,w.useState)(!1),[,te]=(0,w.useState)({}),[ae,ie]=(0,w.useState)(!0),{onError:re,onSuccess:oe}=(0,h.Ls)(V,se),[le]=p.Z.useForm(),ce=(0,w.useMemo)((()=>({from:M,chain:R,destChain:"",asset:"",to:"",value:""})),[R,M]),de=p.Z.useWatch("destChain",le),ue=(0,w.useMemo)((()=>function(e,n,s){if(!e)return[];const t=[],i=s[(0,a.QJ)(e)];return t.push({name:i.name,slug:i.slug}),Object.values(n).forEach((n=>{if(n.srcAsset===e){const e=s[n.destChain];t.push({name:e.name,slug:e.slug})}})),t}(P,z,G)),[G,P,z]),he=(0,w.useMemo)((()=>P?K[P]:void 0),[K,P]),me=(0,w.useMemo)((()=>he?(0,a.eH)(he):0),[he]),ge=(0,h.xo)(R),fe=(0,h.xo)(de),pe=(0,w.useMemo)((()=>function(e,n,s,t,i,r,o,l){var c;const d=(0,g.Jd)(n,e);if(!d)return[];const u=null===(c=(0,f.E_)(s,d.originGenesisHash))||void 0===c?void 0:c.slug,h=(0,A.u)(e),m=!!l&&!!i[l],p=!!l&&!!o[l];if(l){if(!m&&!p)return[];const e=i[l],n=!u||u===(null==e?void 0:e.originChain);if(m){if(F(e,s,h)&&n){const{name:e,originChain:n,slug:s,symbol:t}=i[l];return[{name:e,slug:s,symbol:t,originChain:n}]}return[]}}const x=[];return Object.values(i).forEach((e=>{const n=!u||u===e.originChain;(0,a.Dh)(e)&&F(e,s,h)&&n&&(p?e.multiChainAsset===l&&x.push({name:e.name,slug:e.slug,symbol:e.symbol,originChain:e.originChain}):x.push({name:e.name,slug:e.slug,symbol:e.symbol,originChain:e.originChain}))})),x}(M,q,G,0,K,0,W,S)),[q,K,H,G,$,M,W,S]),xe=(0,w.useCallback)(((e,n)=>{if(!n)return Promise.reject(s("Recipient address is required"));if(!(0,Z.U)(n))return Promise.reject(s("Invalid Recipient address"));const{chain:t,destChain:r,from:o,to:l}=le.getFieldsValue();if(!o||!t||!r)return Promise.resolve();if(t===r){if((0,i.Wr)(o,n))return Promise.reject(s("The recipient address can not be the same as the sender address"));if((0,A.u)(o)&&n&&!(0,A.u)(n)||!(0,A.u)(o)&&n&&(0,A.u)(n))return Promise.reject(s("The recipient address must be same type as the current account address."))}else{const e=(0,a.h4)(G[r]);if(e!==(0,A.u)(l))return Promise.reject(s(`The recipient address must be ${e?"EVM":"substrate"} type`))}return Promise.resolve()}),[G,le,s]),ve=(0,w.useCallback)(((e,n)=>{if(!n)return Promise.reject(s("Amount is required"));if(new b.Z(n).gt(new b.Z(U))){const e=new b.Z(U).div(u.aP.pow(me)).toFixed(6);return Promise.reject(s("Amount must be equal or less than {{number}}",{replace:{number:e}}))}return Promise.resolve()}),[me,U,s]),Ce=(0,w.useCallback)(((e,n)=>{const s=[];if(e.from&&(O(e.from),le.resetFields(["asset"])),e.asset){const t=K[e.asset].originChain;n.value&&s.push("value"),le.setFieldsValue({chain:t,destChain:t}),n.to&&s.push("to"),D(t),L(e.asset),se(!1)}var a;e.destChain&&(e.destChain!==n.chain&&(null===(a=K[n.asset])||void 0===a?void 0:a.assetType)===t.Ym.NATIVE&&se(!1),n.to&&s.push("to")),s.length&&le.validateFields(s).catch(g.ZT)}),[le,O,K,D,L]),be=(0,w.useCallback)((e=>{ee(!0);const{destChain:n,to:s,value:t}=e;let a;a=R===n?(0,m.LV)({from:M,networkKey:R,to:s,tokenSlug:P,value:t,transferAll:ne}):(0,m.X_)({destinationNetworkKey:n,from:M,originNetworkKey:R,tokenSlug:P,to:s,value:t}),setTimeout((()=>{a.then(oe).catch(re).finally((()=>{ee(!1)}))}),300)}),[R,M,P,ne,oe,re]),Te=(0,w.useMemo)((()=>((e,n,s,t)=>{const i=!!t&&!!n[t],r=!!t&&!!s[t];if(!t)return E;const o=Object.values(n).filter((e=>!!(0,a.Dh)(e)&&(i?e.slug===t:!!r&&e.multiChainAsset===t)));return n=>{var s;const t=null===(s=(0,f.E_)(e,n.originGenesisHash))||void 0===s?void 0:s.slug,a=(0,A.u)(n.address);return!!E(n)&&o.some((n=>{const s=!t||t===(null==n?void 0:n.originChain);return F(n,e,a)&&s}))}})(G,K,W,S)),[K,G,W,S]);return(0,w.useEffect)((()=>{const{asset:e,from:n}=le.getFieldsValue();if(pe.length)if(e)pe.some((n=>n.slug===e))||(le.setFieldsValue({asset:pe[0].slug,chain:K[pe[0].slug].originChain,destChain:K[pe[0].slug].originChain}),D(K[pe[0].slug].originChain));else{const e=(0,g.Jd)(q,n);let s=!1;if(null!=e&&e.originGenesisHash){const n=(0,f.E_)(G,e.originGenesisHash);if(n){const e=pe.find((e=>e.originChain===n.slug));e&&(le.setFieldsValue({asset:e.slug,chain:K[e.slug].originChain,destChain:K[e.slug].originChain}),D(K[e.slug].originChain),s=!0)}}s||(le.setFieldsValue({asset:pe[0].slug,chain:K[pe[0].slug].originChain,destChain:K[pe[0].slug].originChain}),D(K[pe[0].slug].originChain))}}),[q,pe,K,le,D,G]),(0,w.useEffect)((()=>{let e=!1;return M&&P&&(0,m.UB)({address:M,networkKey:K[P].originChain,token:P}).then((n=>{!e&&X(n.value),e||le.getFieldValue("value")&&setTimeout((()=>{le.validateFields(["value"]).finally((()=>te({})))}),100)})).catch(console.error),()=>{e=!0}}),[P,K,le,M]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(B.tc,{className:y()(`${e} -transaction-content`),children:[(0,I.jsx)("div",{className:"__brief common-text text-light-4 text-center",children:s("You are doing a token transfer with the following information")}),(0,I.jsxs)(p.Z,{className:"form-container form-space-sm",form:le,initialValues:ce,onFinish:be,onValuesChange:Ce,children:[(0,I.jsx)(p.Z.Item,{className:y()({hidden:!J}),name:"from",children:(0,I.jsx)(r.p,{addressPrefix:ge,disabled:!J,filter:Te,label:s("Send from account")})}),(0,I.jsxs)("div",{className:"form-row",children:[(0,I.jsx)(p.Z.Item,{name:"asset",children:(0,I.jsx)(d.k,{disabled:!pe.length,items:pe,placeholder:s("Select token"),showChainInSelected:!0,tooltip:s("Token")})}),(0,I.jsx)(p.Z.Item,{name:"value",rules:[{validator:ve}],statusHelpAsTooltip:!0,validateTrigger:"onBlur",children:(0,I.jsx)(l.ZP,{decimals:me,maxValue:U,onSetMax:se,showMaxButton:R===de&&(null===(n=K[P])||void 0===n?void 0:n.assetType)===t.Ym.NATIVE,tooltip:s("Amount")})})]}),(0,I.jsx)(p.Z.Item,{className:"hidden",name:"chain",children:(0,I.jsx)(x.Z,{placeholder:s("value")})}),(0,I.jsx)(p.Z.Item,{name:"to",rules:[{validator:xe}],statusHelpAsTooltip:!0,validateTrigger:"onBlur",children:(0,I.jsx)(o.J,{addressPrefix:fe,label:s("Send to account"),showScanner:!0})}),(0,I.jsx)(p.Z.Item,{name:"destChain",children:(0,I.jsx)(c.o,{disabled:!ue.length,items:ue,title:s("Select destination chain"),tooltip:s("Destination chain")})})]}),(0,I.jsx)(B.ZL,{address:M,chain:R,onBalanceReady:ie,tokenSlug:P})]}),(0,I.jsx)(B.Xd,{className:`${e} -transaction-footer`,errors:[],warnings:[],children:(0,I.jsx)(v.Z,{disabled:!ae,icon:(0,I.jsx)(C.Z,{phosphorIcon:j.Z,weight:"fill"}),loading:Q,onClick:Y(le.submit),schema:ne?"warning":void 0,children:s(ne?"Transfer the full account balance":"Transfer")})})]})})).withConfig({displayName:"SendFund",componentId:"sc-wyykvt-0"})((({theme:e})=>{const n=e.token;return{".__brief":{paddingLeft:n.padding,paddingRight:n.padding,marginBottom:n.marginMD},"&.-transaction-content.-is-zero-balance":{".free-balance .ant-number":{".ant-number-integer, .ant-number-decimal":{color:`${n.colorError} !important`}}}}}))}}]);