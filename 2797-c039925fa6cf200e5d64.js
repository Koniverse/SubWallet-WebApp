"use strict";(("undefined"!=typeof self?self:this).webpackChunk_subwallet_web_runner=("undefined"!=typeof self?self:this).webpackChunk_subwallet_web_runner||[]).push([[2797,3738],{13738:(e,s,n)=>{n.r(s),n.d(s,{TransactionContext:()=>C,default:()=>b});var t=n(9661),a=n(31101),i=n(11637),r=n(87574),o=n(75576),l=n(33283),c=n(12162),d=n(90809),u=n(72779),h=n.n(u),m=n(2784),g=n(35185),f=n(73557),p=n(38338),x=n(68774),v=n(52322);const C=m.createContext({transactionType:t.Vv.TRANSFER_BALANCE,from:"",setFrom:e=>{},chain:"",setChain:e=>{},asset:"",setAsset:e=>{},onDone:e=>{},onClickRightBtn:()=>{},setShowRightBtn:e=>{},setDisabledRightBtn:e=>{}}),b=(0,p.ZP)((function({className:e}){const{t:s}=(0,l.$G)(),n=(0,f.TH)(),u=(0,f.s0)(),{activeModal:p}=(0,m.useContext)(c.t),b=(0,m.useContext)(o.R0),{currentAccount:T,isAllAccount:y}=(0,g.v9)((e=>e.accountState)),w=(0,m.useMemo)((()=>{switch(n.pathname.split("/")[2]||""){case"stake":return t.Vv.STAKING_JOIN_POOL;case"unstake":return t.Vv.STAKING_LEAVE_POOL;case"cancel-unstake":return t.Vv.STAKING_CANCEL_UNSTAKE;case"claim-reward":return t.Vv.STAKING_CLAIM_REWARD;case"withdraw":return t.Vv.STAKING_WITHDRAW;case"compound":return t.Vv.STAKING_COMPOUNDING;case"send-nft":return t.Vv.SEND_NFT;default:return t.Vv.TRANSFER_BALANCE}}),[n.pathname]),j=(0,m.useMemo)((()=>{switch(n.pathname.split("/")[2]||""){case"stake":case"unstake":case"cancel-unstake":case"claim-reward":case"withdraw":case"compound":return"/home/staking";case"send-nft":return"/home/nfts/collections";default:return"/home/tokens"}}),[n.pathname]),k=(0,m.useMemo)((()=>{const e={};for(const[n,t]of Object.entries(r.mG))e[n]=s(t);return e}),[s]);(0,l.qg)(j);const[N,S]=(0,m.useState)(y?"":(null==T?void 0:T.address)||""),[A,Z]=(0,m.useState)(""),[B,_]=(0,m.useState)(""),[I,E]=(0,m.useState)(!1),[F,P]=(0,m.useState)(!1),R=(0,l.xC)(),M=(0,m.useCallback)((()=>{u(j)}),[j,u]),V=(0,m.useCallback)((e=>{const s=(0,x.u)(N)?"ethereum":"substrate";u(`/transaction-done/${s}/${A}/${e}`,{replace:!0})}),[N,A,u]),L=(0,m.useCallback)((()=>{w===t.Vv.STAKING_JOIN_POOL&&p(i.p)}),[p,w]),D=(0,m.useMemo)((()=>I?[{disabled:F,icon:(0,v.jsx)(a.sz,{}),onClick:()=>L()}]:[]),[F,L,I]);return(0,m.useEffect)((()=>{""!==B&&R(B)}),[B,R]),(0,v.jsx)(a.Ar.Home,{showFilterIcon:!0,showTabBar:!1,children:(0,v.jsx)(C.Provider,{value:{transactionType:w,from:N,setFrom:S,chain:A,setChain:Z,onDone:V,onClickRightBtn:L,setShowRightBtn:E,setDisabledRightBtn:P,asset:B,setAsset:_},children:(0,v.jsx)(a.FE,{resolve:b.awaitStores(["chainStore","assetRegistry","balance"]),children:(0,v.jsxs)("div",{className:h()(e,"transaction-wrapper"),children:[(0,v.jsx)(d.Z,{background:"transparent",center:!0,className:"transaction-header",onBack:M,rightButtons:D,showBackButton:!0,title:k[w]}),(0,v.jsx)(f.j3,{})]})})})})})).withConfig({displayName:"Transaction",componentId:"sc-1qz55vb-0"})((({theme:e})=>{const s=e.token;return{height:"100%",display:"flex",flexDirection:"column",".transaction-header":{paddingTop:s.paddingSM,paddingBottom:s.paddingSM,flexShrink:0},".transaction-content":{flex:"1 1 400px",paddingLeft:s.padding,paddingRight:s.padding,overflow:"auto"},".transaction-footer":{display:"flex",flexWrap:"wrap",padding:`${s.paddingMD}px ${s.padding}px ${s.padding}px`,marginBottom:s.padding,gap:s.paddingXS,".error-messages":{width:"100%",color:s.colorError},".warning-messages":{width:"100%",color:s.colorWarning},".ant-btn":{flex:1},".full-width":{minWidth:"100%"}}}}))},94684:(e,s,n)=>{n.d(s,{gy:()=>u,ZL:()=>g,tc:()=>f,Xd:()=>p});var t=n(43246),a=n(96562),i=n(25690),r=n(72779),o=n.n(r),l=n(2784),c=n(38338),d=n(52322);const u=(0,c.ZP)((({bondedBalance:e,className:s,decimals:n,label:r,symbol:l})=>{const{t:u}=(0,t.Z)(),{token:h}=(0,c.Fg)();return(0,d.jsxs)(a.Z.Paragraph,{className:o()(s,"bonded-balance"),children:[(0,d.jsx)(i.Z,{decimal:n,decimalColor:h.colorTextTertiary,intColor:h.colorTextTertiary,size:14,suffix:l,unitColor:h.colorTextTertiary,value:e||0}),r||u("Bonded")]})})).withConfig({displayName:"BondedBalance",componentId:"sc-15arqr7-0"})((({theme:{token:e}})=>({display:"flex",color:e.colorTextTertiary,"&.ant-typography":{marginBottom:0},".ant-number":{marginRight:"0.3em"}})));var h=n(33283),m=n(96108);const g=(0,c.ZP)((({address:e,chain:s,className:n,label:r,onBalanceReady:u,tokenSlug:g})=>{const{t:f}=(0,t.Z)(),{token:p}=(0,c.Fg)(),{error:x,isLoading:v,nativeTokenBalance:C,nativeTokenSlug:b,tokenBalance:T}=(0,h.L5)(s,e,g);return(0,l.useEffect)((()=>{null==u||u(!v&&!x)}),[x,v,u]),e||s?(0,d.jsxs)(a.Z.Paragraph,{className:o()(n,"free-balance"),children:[r||f("Sender available balance:")," ",v&&(0,d.jsx)(m.Z,{size:14}),x&&(0,d.jsx)(a.Z.Text,{className:"error-message",children:x}),!v&&!x&&!!b&&(0,d.jsx)(i.Z,{decimal:C.decimals||18,decimalColor:p.colorTextTertiary,intColor:p.colorTextTertiary,size:14,suffix:C.symbol,unitColor:p.colorTextTertiary,value:C.value}),!v&&!x&&!!g&&g!==b&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("span",{className:"__name",children:[" ",f("and")," "]}),(0,d.jsx)(i.Z,{decimal:(null==T?void 0:T.decimals)||18,decimalColor:p.colorTextTertiary,intColor:p.colorTextTertiary,size:14,suffix:null==T?void 0:T.symbol,unitColor:p.colorTextTertiary,value:T.value})]})]}):(0,d.jsx)(d.Fragment,{})})).withConfig({displayName:"FreeBalance",componentId:"sc-f3bkwa-0"})((({theme:{token:e}})=>({display:"flex",flexWrap:"wrap",color:e.colorTextTertiary,".error-message":{color:e.colorError},"&.ant-typography":{marginBottom:0}}))),f=(0,c.ZP)((({children:e,className:s=""})=>(0,d.jsx)("div",{className:`transaction-content ${s}`,children:e}))).withConfig({displayName:"TransactionContent",componentId:"sc-17nushy-0"})((({theme:e})=>({}))),p=(0,c.ZP)((({children:e,className:s="",errors:n,warnings:t})=>(0,d.jsxs)("div",{className:`transaction-footer ${s}`,children:[n.length>0&&(0,d.jsx)("div",{className:"error-messages",children:n.map(((e,s)=>(0,d.jsx)("div",{children:e},s)))}),t.length>0&&(0,d.jsx)("div",{className:"warning-messages",children:t.map(((e,s)=>(0,d.jsx)("div",{children:e},s)))}),e]}))).withConfig({displayName:"TransactionFooter",componentId:"sc-bpci6r-0"})((({theme:e})=>({})))},42797:(e,s,n)=>{n.r(s),n.d(s,{default:()=>F});var t=n(80949),a=n(36926),i=n(56858),r=n(76806),o=n(32623),l=n(92323),c=n(23214),d=n(11638),u=n(33283),h=n(92936),m=n(95798),g=n(32897),f=n(12798),p=n(25356),x=n(92280),v=n(99656),C=n(72558),b=n(72779),T=n.n(b),y=n(62982),w=n(2784),j=n(96217),k=n(73557),N=n(38338),S=n(68774),A=n(61162),Z=n(94684),B=n(13738),_=n(52322);function I(e,s,n){return(0,a.h4)(s[e.originChain])===n}const E=e=>!((0,m.W_)(e.address)||e.isReadOnly),F=(0,N.ZP)((({className:e=""})=>{var s;const{t:n}=(0,j.$)(),b=(0,u.lm)(),N=(0,k.TH)().state,[F]=(0,w.useState)(null==N?void 0:N.slug),{asset:P,chain:R,from:M,onDone:V,setAsset:L,setChain:D,setFrom:O}=(0,w.useContext)(B.TransactionContext),{chainInfoMap:G,chainStateMap:$}=(0,u.v9)((e=>e.chainStore)),{assetRegistry:H,assetSettingMap:K,multiChainAssetMap:W,xcmRefMap:z}=(0,u.v9)((e=>e.assetRegistry)),{accounts:J,isAllAccount:q}=(0,u.v9)((e=>e.accountState)),[U,X]=(0,w.useState)("0"),Y=(0,u.Ey)(M,"The account you are using is read-only, you cannot send assets with it"),[Q,ee]=(0,w.useState)(!1),[se,ne]=(0,w.useState)(!1),[,te]=(0,w.useState)({}),[ae,ie]=(0,w.useState)(!0),{onError:re,onSuccess:oe}=(0,u.Ls)(V,ne),[le]=f.Z.useForm(),ce=(0,w.useMemo)((()=>({from:M,chain:R,destChain:"",asset:"",to:"",value:""})),[R,M]),de=f.Z.useWatch("destChain",le),ue=(0,w.useMemo)((()=>function(e,s,n){if(!e)return[];const t=[],i=n[(0,a.QJ)(e)];return t.push({name:i.name,slug:i.slug}),Object.values(s).forEach((s=>{if(s.srcAsset===e){const e=n[s.destChain];t.push({name:e.name,slug:e.slug})}})),t}(P,z,G)),[G,P,z]),he=(0,w.useMemo)((()=>P?H[P]:void 0),[H,P]),me=(0,w.useMemo)((()=>he?(0,a.eH)(he):0),[he]),ge=(0,u.xo)(R),fe=(0,u.xo)(de),pe=(0,w.useMemo)((()=>function(e,s,n,t,i,r,o,l){var c;const d=(0,m.Jd)(s,e);if(!d)return[];const u=null===(c=(0,g.E_)(n,d.originGenesisHash))||void 0===c?void 0:c.slug,h=(0,S.u)(e),f=!!l&&!!i[l],p=!!l&&!!o[l];if(l){if(!f&&!p)return[];const e=i[l],s=!u||u===(null==e?void 0:e.originChain);if(f){if(I(e,n,h)&&s){const{name:e,originChain:s,slug:n,symbol:t}=i[l];return[{name:e,slug:n,symbol:t,originChain:s}]}return[]}}const x=[];return Object.values(i).forEach((e=>{const s=!u||u===e.originChain;(0,a.Dh)(e)&&I(e,n,h)&&s&&(p?e.multiChainAsset===l&&x.push({name:e.name,slug:e.slug,symbol:e.symbol,originChain:e.originChain}):x.push({name:e.name,slug:e.slug,symbol:e.symbol,originChain:e.originChain}))})),x}(M,J,G,0,H,0,W,F)),[J,H,K,G,$,M,W,F]),xe=(0,w.useCallback)(((e,s)=>{if(!s)return Promise.reject(n("Recipient address is required"));if(!(0,A.U)(s))return Promise.reject(n("Invalid Recipient address"));const{chain:t,destChain:r,from:o,to:l}=le.getFieldsValue();if(!o||!t||!r)return Promise.resolve();if(t===r){if((0,i.Wr)(o,s))return Promise.reject(n("The recipient address can not be the same as the sender address"));if((0,S.u)(o)&&s&&!(0,S.u)(s)||!(0,S.u)(o)&&s&&(0,S.u)(s))return Promise.reject(n("The recipient address must be same type as the current account address."))}else{const e=(0,a.h4)(G[r]);if(e!==(0,S.u)(l))return Promise.reject(n(`The recipient address must be ${e?"EVM":"substrate"} type`))}return Promise.resolve()}),[G,le,n]),ve=(0,w.useCallback)(((e,s)=>{if(!s)return Promise.reject(n("Amount is required"));if(new C.Z(s).gt(new C.Z(U))){const e=(0,m.az)(U,me);return Promise.reject(n("Amount must be equal or less than {{number}}",{replace:{number:e}}))}return Promise.resolve()}),[me,U,n]),Ce=(0,w.useCallback)(((e,s)=>{const n=[];if(e.from&&(O(e.from),le.resetFields(["asset"])),e.asset){const t=H[e.asset].originChain;s.value&&n.push("value"),le.setFieldsValue({chain:t,destChain:t}),s.to&&n.push("to"),D(t),L(e.asset),ne(!1)}var a;e.destChain&&(e.destChain!==s.chain&&(null===(a=H[s.asset])||void 0===a?void 0:a.assetType)===t.Ym.NATIVE&&ne(!1),s.to&&n.push("to")),n.length&&le.validateFields(n).catch(m.ZT)}),[le,O,H,D,L]),be=(0,w.useCallback)((e=>{ee(!0);const{destChain:s,to:t,value:a}=e;let i;if(R===s)i=(0,h.LV)({from:M,networkKey:R,to:t,tokenSlug:P,value:a,transferAll:se});else{const e=(0,m.Jd)(J,M);if(null!=e&&e.isHardware)return ee(!1),void b({message:n("This feature is not available for Ledger account"),type:"warning"});i=(0,h.X_)({destinationNetworkKey:s,from:M,originNetworkKey:R,tokenSlug:P,to:t,value:a})}setTimeout((()=>{i.then(oe).catch(re).finally((()=>{ee(!1)}))}),300)}),[R,M,P,se,J,b,n,oe,re]),Te=(0,w.useMemo)((()=>((e,s,n,t)=>{const i=!!t&&!!s[t],r=!!t&&!!n[t];if(!t)return E;const o=Object.values(s).filter((e=>!!(0,a.Dh)(e)&&(i?e.slug===t:!!r&&e.multiChainAsset===t)));return s=>{var n;const t=null===(n=(0,g.E_)(e,s.originGenesisHash))||void 0===n?void 0:n.slug,a=(0,S.u)(s.address);return!!E(s)&&o.some((s=>{const n=!t||t===(null==s?void 0:s.originChain);return I(s,e,a)&&n}))}})(G,H,W,F)),[H,G,W,F]);return(0,w.useEffect)((()=>{const{asset:e,from:s}=le.getFieldsValue();if(pe.length)if(e)pe.some((s=>s.slug===e))||(le.setFieldsValue({asset:pe[0].slug,chain:H[pe[0].slug].originChain,destChain:H[pe[0].slug].originChain}),D(H[pe[0].slug].originChain));else{const e=(0,m.Jd)(J,s);let n=!1;if(null!=e&&e.originGenesisHash){const s=(0,g.E_)(G,e.originGenesisHash);if(s){const e=pe.find((e=>e.originChain===s.slug));e&&(le.setFieldsValue({asset:e.slug,chain:H[e.slug].originChain,destChain:H[e.slug].originChain}),D(H[e.slug].originChain),n=!0)}}n||(le.setFieldsValue({asset:pe[0].slug,chain:H[pe[0].slug].originChain,destChain:H[pe[0].slug].originChain}),D(H[pe[0].slug].originChain))}}),[J,pe,H,le,D,G]),(0,w.useEffect)((()=>{let e=!1;return M&&P&&(0,h.UB)({address:M,networkKey:H[P].originChain,token:P}).then((s=>{!e&&X(s.value)})).catch((()=>{!e&&X("0")})).finally((()=>{e||le.getFieldValue("value")&&setTimeout((()=>{le.validateFields(["value"]).finally((()=>te({})))}),100)})),()=>{e=!0}}),[P,H,K,le,M]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(Z.tc,{className:T()(`${e} -transaction-content`),children:[(0,_.jsx)("div",{className:"__brief common-text text-light-4 text-center",children:n("You are doing a token transfer with the following information")}),(0,_.jsxs)(f.Z,{className:"form-container form-space-sm",form:le,initialValues:ce,onFinish:be,onValuesChange:Ce,children:[(0,_.jsx)(f.Z.Item,{className:T()({hidden:!q}),name:"from",children:(0,_.jsx)(r.p,{addressPrefix:ge,disabled:!q,filter:Te,label:n("Send from account")})}),(0,_.jsxs)("div",{className:"form-row",children:[(0,_.jsx)(f.Z.Item,{name:"asset",children:(0,_.jsx)(d.k,{disabled:!pe.length,items:pe,placeholder:n("Select token"),showChainInSelected:!0,tooltip:n("Token")})}),(0,_.jsx)(f.Z.Item,{name:"value",rules:[{validator:ve}],statusHelpAsTooltip:!0,validateTrigger:"onBlur",children:(0,_.jsx)(l.ZP,{decimals:me,maxValue:U,onSetMax:ne,showMaxButton:R===de&&(null===(s=H[P])||void 0===s?void 0:s.assetType)===t.Ym.NATIVE,tooltip:n("Amount")})})]}),(0,_.jsx)(f.Z.Item,{className:"hidden",name:"chain",children:(0,_.jsx)(p.Z,{placeholder:n("value")})}),(0,_.jsx)(f.Z.Item,{name:"to",rules:[{validator:xe}],statusHelpAsTooltip:!0,validateTrigger:"onBlur",children:(0,_.jsx)(o.J,{addressPrefix:fe,label:n("Send to account"),showAddressBook:!0,showScanner:!0})}),(0,_.jsx)(f.Z.Item,{name:"destChain",children:(0,_.jsx)(c.o,{disabled:!ue.length,items:ue,title:n("Select destination chain"),tooltip:n("Destination chain")})})]}),(0,_.jsx)(Z.ZL,{address:M,chain:R,onBalanceReady:ie,tokenSlug:P})]}),(0,_.jsx)(Z.Xd,{className:`${e} -transaction-footer`,errors:[],warnings:[],children:(0,_.jsx)(x.Z,{disabled:!ae,icon:(0,_.jsx)(v.Z,{phosphorIcon:y.Z,weight:"fill"}),loading:Q,onClick:Y(le.submit),schema:se?"warning":void 0,children:n(se?"Transfer the full account balance":"Transfer")})})]})})).withConfig({displayName:"SendFund",componentId:"sc-wyykvt-0"})((({theme:e})=>{const s=e.token;return{".__brief":{paddingLeft:s.padding,paddingRight:s.padding,marginBottom:s.marginMD},"&.-transaction-content.-is-zero-balance":{".free-balance .ant-number":{".ant-number-integer, .ant-number-decimal":{color:`${s.colorError} !important`}}}}}))}}]);